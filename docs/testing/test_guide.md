# HR招聘系统测试指南

## 测试环境配置

### 环境变量设置
测试环境需要设置以下环境变量：
```bash
export APP_ENV=testing
export SERVICE_MODE=mock
export TESTING=True
```

### 数据库配置
测试环境默认使用内存数据库：
```python
DATABASE_URL = "sqlite:///:memory:"
```

## 测试类型

### 单元测试
单元测试用于测试各个组件的独立功能，位于`tests/unit/`目录下。

运行单元测试：
```bash
cd backend
python -m pytest tests/unit/
```

### 集成测试
集成测试用于测试多个组件之间的交互，位于`tests/integration/`目录下。

运行集成测试：
```bash
cd backend
python -m pytest tests/integration/
```

### 端到端测试
端到端测试用于测试完整的业务流程，位于`tests/e2e/`目录下。

运行端到端测试：
```bash
cd backend
python -m pytest tests/e2e/
```

### 前端测试
前端测试用于测试Vue组件的功能，位于`frontend/tests/`目录下。

运行前端测试：
```bash
cd frontend
npm run test
```

## 测试覆盖率

检查测试覆盖率：
```bash
cd backend
python -m pytest --cov=app tests/
```

当前测试覆盖率约为64%。

## 模拟服务

系统使用模拟服务来替代外部依赖，包括：

1. **GPT服务**：模拟GPT-4的功能，用于简历解析、人才画像生成等
2. **OCR服务**：模拟阿里云OCR服务，用于简历文本提取
3. **存储服务**：模拟阿里云OSS存储服务，用于文件存储

模拟服务配置在`app/services/`目录下的`*_mock.py`文件中。

## 测试数据

### 简历测试数据
测试简历位于`tests/fixtures/`目录下，包括PDF和Word格式的简历样本。

### 职位测试数据
测试职位数据在测试运行时动态生成。

## 常见问题

### 配置问题
如果遇到配置相关的测试失败，请检查：
1. 环境变量是否正确设置
2. 配置文件中的类型转换是否正确

### 服务模式问题
如果遇到服务相关的测试失败，请检查：
1. SERVICE_MODE是否设置为"mock"
2. 模拟服务是否正确实现了所需的方法

### 数据库问题
如果遇到数据库相关的测试失败，请检查：
1. 数据库连接是否正确
2. 测试前是否正确初始化了数据库

## 测试流程要求

1. 在测试环境中进行所有测试
2. 使用真实的测试用例，不使用模拟数据
3. 在前端完整执行1-2个端到端流程测试
4. 测试所有可能受影响的功能模块
5. 主动监控并收集前端日志和控制台(F12)信息进行调试
6. 只有在完成全面测试后才能合并到生产环境

## 最近修复的问题

1. 配置模块中环境变量类型转换问题，确保布尔值正确处理
2. 匹配服务中的参数处理问题，增加了兼容性处理
3. 测试配置单例的重置逻辑，防止测试之间相互干扰
